<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Johzzy Pages</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="some code, some note.">
<meta property="og:type" content="website">
<meta property="og:title" content="Johzzy Pages">
<meta property="og:url" content="https://johzzy.github.io/page/2/index.html">
<meta property="og:site_name" content="Johzzy Pages">
<meta property="og:description" content="some code, some note.">
<meta property="og:locale">
<meta property="article:author" content="johzzy">
<meta name="twitter:card" content="summary">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/public/css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/public/" id="logo">Johzzy Pages</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/public/">Home</a>
        
          <a class="main-nav-link" href="/public/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://johzzy.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-2016-07-28-centos_upgrade_gcc" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/public/2016/07/28/2016-07-28-centos_upgrade_gcc/" class="article-date">
  <time datetime="2016-07-28T01:45:50.000Z" itemprop="datePublished">2016-07-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/public/categories/%E6%9C%AA%E5%88%86%E7%B1%BB/">未分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/public/2016/07/28/2016-07-28-centos_upgrade_gcc/">CentOS 升级 GCC 整理记录</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>CentOS 升级 GCC 整理记录</p>
<pre><code>CentOS 版本: 6.0 (x64)
GCC 原版本： 4.4.7
GCC 升级版本：4.8.5
GCC 4.8.5 链接： https://ftp.gnu.org/gnu/gcc/gcc-4.8.5/gcc-4.8.5.tar.gz
</code></pre><p>执行过程</p>
<pre><code>wget https://ftp.gnu.org/gnu/gcc/gcc-4.8.5/gcc-4.8.5.tar.gz
tar zxf gcc-4.8.5.tar.gz
cd gcc-4.8.5

yum install gcc g++
yum install glibc-static
yum install cloog-ppl gmp-devel

wget ftp://gcc.gnu.org/pub/gcc/infrastructure/isl-0.11.1.tar.bz2
tar jxf isl-0.11.1.tar.bz2
cd isl-0.11.1
./configure
make
make install

cd ..
./contrib/download_prerequisites
mkdir build
cd build
../configure --prefix=/usr --enable-languages=c,c++ --disable-multilib
make -j4
make install
</code></pre><p>GCC 4.8.5 支持 C++11 的部分特性</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://johzzy.github.io/2016/07/28/2016-07-28-centos_upgrade_gcc/" data-id="ckqhkhszj000ouavq4onda0ii" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2016-6-6-browser-plugin" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/public/2016/06/06/2016-6-6-browser-plugin/" class="article-date">
  <time datetime="2016-06-06T04:40:05.000Z" itemprop="datePublished">2016-06-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/public/categories/%E6%9C%AA%E5%88%86%E7%B1%BB/">未分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/public/2016/06/06/2016-6-6-browser-plugin/">浏览器插件</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Chrome 插件</p>
<pre><code>1. ADfree.Player.Online
一款屏蔽国内主要视频网站部分视频广告的扩展。

2. Allow Copy
解除一些网站不允许的右键复制

3. Bookmark Manager
来自 google

4. ChaZD
ChaZD 查字典，简洁易用的英汉字典扩展程序，支持划词哦:)

5. crxMouse Chrome Gestures
Boost browsing productivity with your fingertips - Mouse Gestures, Super Drag, Wheel Gestures, Rocker Gestures.
(不经常使用, 更多使用 vim 插件)

6. Disconnect
Make the web faster, more private, and more secure.
(google 已跪, 可以使用 duckduckgo)

7. Ghostery
Enjoy a faster, safer and cleaner browsing experience.
(用于屏蔽网页的一些信息跟踪)

8. Google Art Project
Art Project masterpieces from Google Cultural Institute in your browser tabs
(还行)

9. HTTPS Everywhere
Encrypt the Web! Automatically use HTTPS security on many sites.
(提高安全姿势)

10. ImprovedTube - YouTube Extension
Improves YouTube&apos;s functions and site with Limited Permissions. Auto HD, Resize, Annotations, Playback Speed and more.
(美化youtube, 不及 Magic Actions)

11. iReader
View news stories and other articles in a very easy to read, clutter-free, scrollable display.
(阅读模式)

12. Magic Actions for YouTube™
Enhance your YouTube watching experience! Auto HD, Ad Block, Cinema Mode, Mouse Wheel Volume Control, Screenshot...
(更加美化youtube)

13. Octotree
Code tree for GitHub and GitLab
(神器)

14. OneTab
Save up to 95% memory and reduce tab clutter
(节省资源)

15. Privacy Badger
Privacy Badger protects you from trackers as you surf the web!
(隐私安全)

16. Proxy SwitchyOmega
Manage and switch between multiple proxies quickly &amp; easily.
(科学上网)

17. Redirector
Automatically redirect pages based on user-defined rules. E.g. always redirect an article url to its printer-friendly version.

18. Remove Google Redirection
Prohibit click-tracking, and prevent url redirection when clicks on the result links in Google search page

19. scroll style
Like android&apos;s scroll bars .像android的滚动条

20. StopFingerprinting
Fingerprinting analysis extension.
(隐私安全, 不知是否有效)

21. Stylish
Restyle the web with Stylish, a user styles manager. Stylish lets you easily install themes and skins for many popular sites.
(神器, 自定义 css 样式)

22. Tampermonkey
The most popular userscript manager for Blink-based browsers
(神器, 自定义 js 样式)

23. The Great Suspender
Automatically suspends unused tabs to free up system resources
(节省资源, 配合 OneTab)

24. User-Agent Switcher for Google Chrome
User-Agent Switcher for Google Chrome switches between different user-agents.

25. Vimium
The Hacker&apos;s Browser. Vimium provides keyboard shortcuts for navigation and control in the spirit of Vim.
(神器, 已上瘾)

26. WebRTC Leak Prevent
Prevent WebRTC leaks, without blocking WebRTC.
(安全, 隐藏本地IP)

27. 买买买购物助手
(还没有使用)

28. 保护眼睛
阿姆斯特朗回旋喷气式阿姆斯特朗墨镜

29. 隐藏帖自动回复 (AutoReply 纯净版)
自动回复隐藏帖 (要求已登录, 改自同名 Chrome 插件, 版权归原作者所有)
</code></pre><p>Firefox</p>
<pre><code>ACVAA
Adblock Plus
Disconnect
Disconnect Search
Element Hiding Helper for Adblock Plus
FEBE
FoxyProxy Standard
Ghostery
Greasemonkey
HTTPS-Everywhere
NoScript
Omnibar
PopVideo
SmartVideo For YouTube
Vimperator
</code></pre><p>以下在破坏本文规则</p>
<p>PowerShell</p>
<pre><code>posh-git
PowerTab
PSCX
PsGet
PSReadline
</code></pre><p>Zsh</p>
<pre><code>git 
incr  
terminitor 
tmux
z 
zsh-history-substring-search
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://johzzy.github.io/2016/06/06/2016-6-6-browser-plugin/" data-id="ckqhkhszp0013uavqbepa59l2" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2016-4-13-my-string-format" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/public/2016/04/13/2016-4-13-my-string-format/" class="article-date">
  <time datetime="2016-04-13T09:57:35.000Z" itemprop="datePublished">2016-04-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/public/categories/%E6%9C%AA%E5%88%86%E7%B1%BB/">未分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/public/2016/04/13/2016-4-13-my-string-format/">一种字符串序列描述</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>将两个序列</p>
<pre><code>A = &#123;1, 4, 6, 8, 9&#125;
B = &#123;10, 11, 12, ...20&#125;
</code></pre><p>转为如下形式</p>
<pre><code>string a = &quot;1,4,6,8-9&quot;;
string b = &quot;10-20&quot;; 
</code></pre><p>实现如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">QString SeriesEdit::FormatSeries(const QSet&lt;int&gt;&amp; series)</span><br><span class="line">&#123;	</span><br><span class="line">	QList&lt;int&gt; series_list = series.toList();</span><br><span class="line">	qSort(series_list.begin(), series_list.end());</span><br><span class="line"></span><br><span class="line">	int last = 0xffffffff;</span><br><span class="line">	bool match = false;</span><br><span class="line"></span><br><span class="line">	QString series_str;</span><br><span class="line">	for (QList&lt;int&gt;::iterator it = series_list.begin(); it != series_list.end(); ++it)</span><br><span class="line">	&#123;</span><br><span class="line">		int var = *it;</span><br><span class="line">		if (it == series_list.begin())</span><br><span class="line">		&#123;</span><br><span class="line">			series_str += QString::number(var);</span><br><span class="line">		&#125;</span><br><span class="line">		else if (last + 1 == var)</span><br><span class="line">		&#123;</span><br><span class="line">			series_str += &quot;-&quot;;</span><br><span class="line">			match = true;</span><br><span class="line">		&#125;</span><br><span class="line">		else if (match)</span><br><span class="line">		&#123;			</span><br><span class="line">			series_str += QString::number(last) + &quot;,&quot; + QString::number(var);</span><br><span class="line">			match = false;</span><br><span class="line">		&#125;	</span><br><span class="line">		else</span><br><span class="line">		&#123;</span><br><span class="line">			series_str += &quot;,&quot; + QString::number(var);</span><br><span class="line">		&#125;</span><br><span class="line">		last = *it;</span><br><span class="line">	&#125;</span><br><span class="line">	if (match)</span><br><span class="line">	&#123;</span><br><span class="line">		series_str += QString::number(last);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	return series_str.split(&quot;-&quot;, QString::SkipEmptyParts).join(&quot;-&quot;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://johzzy.github.io/2016/04/13/2016-4-13-my-string-format/" data-id="ckqhkhszo0010uavq669l6z67" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2016-1-18-C++中set和get的简单方式" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/public/2016/01/18/2016-1-18-C++%E4%B8%ADset%E5%92%8Cget%E7%9A%84%E7%AE%80%E5%8D%95%E6%96%B9%E5%BC%8F/" class="article-date">
  <time datetime="2016-01-18T02:46:05.000Z" itemprop="datePublished">2016-01-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/public/categories/%E6%9C%AA%E5%88%86%E7%B1%BB/">未分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/public/2016/01/18/2016-1-18-C++%E4%B8%ADset%E5%92%8Cget%E7%9A%84%E7%AE%80%E5%8D%95%E6%96%B9%E5%BC%8F/">C++中set和get的简单方式</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在C#中, 有比较通用的set和get, 在C++中可以使用引用和访问限制符来简单处理,   具体如下</p>
<pre><code>`
#define SUCCESS 1 // #define SUCCESS 1
#define FAIL 0 // #define FAIL 0
#include &lt;iostream&gt;
int add(int a, int b) &#123; return a + b; &#125;
class A
&#123;
private:
    int a_;
    int b_;
public:
    const int&amp; a;
    const int&amp; b;
public:
    int x_;
    int y_;
    const int&amp; x;
    const int&amp; y;
    A()
    : a_(0), b_(0), x_(0), y_(0)
    , a(a_), b(b_), x(x_), y(y_)
    &#123;&#125;

    void print() &#123; 
        std::cout &lt;&lt; &quot;  a=&quot; &lt;&lt; a &lt;&lt; &quot;, a_=&quot; &lt;&lt; a_ 
              &lt;&lt; &quot;, b=&quot; &lt;&lt; b &lt;&lt; &quot;, b_=&quot; &lt;&lt; b_
              &lt;&lt; &quot;, x=&quot; &lt;&lt; x &lt;&lt; &quot;, x_=&quot; &lt;&lt; x_
              &lt;&lt; &quot;, y=&quot; &lt;&lt; y &lt;&lt; &quot;, y_=&quot; &lt;&lt; y_
                          &lt;&lt; &quot;.\n&quot;;
    &#125;
&#125;;

int  main()
&#123;
    int result = add(SUCCESS, FAIL);
    A a;
    a.x_ = 4;    // (1) 
    //a.x = 5;    // (2) 
    //a.a_ = 3; // (3)
    //a.a = 5;  // (4)
    a.y_ = a.x; // (5)
    // a.y = a.x; // (6)
    // a.a = a.y; // (7)    
    a.print();
    return 0;
&#125;
`
</code></pre><p>其中,</p>
<p>(1) <code>public int x_</code>, 跟全局变量的访问一样<br>(2) <code>a.x</code> 为 <code>public int&amp;</code> 类型, 指向<code>public int x_</code>, 这里相当于 <code>set</code><br>(3) error, <code>private int a_</code> 尝试修改私有变量的值<br>(4) error, <code>public const int&amp; y</code> 尝试修改<code>const</code>变量<br>(5) <code>a.x</code> 相当于<code>get</code>, 并修改 <code>y_</code><br>(6) <code>error</code>, <code>public const int&amp; y</code> 尝试修改<code>const</code>变量<br>(7) <code>error</code>, <code>a.x</code> 相当于<code>get</code>, <code>a.a</code> 尝试修改<code>const</code>变量  </p>
<p>对此，如果一个变量 <code>var</code> 是只读的，但是在对象构造时需要赋值, 可以参照如下方式</p>
<pre><code>class A 
&#123;
private:
    int var_;
public:
    const int&amp; var;
public:
    A(int a):var_(a)&#123;&#125;
    Foo() &#123; /*process var_*/ &#125;
&#125;;
</code></pre><p>于是, 在初始化是可以 <code>A a(5)</code>, 在<code>a</code>的内部, 仍然可以对 <code>var_</code> 做任何处理, 使用时 <code>a.var</code>, 而不必考虑<code>var</code>被外界修改的问题.</p>
<p>(完)</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://johzzy.github.io/2016/01/18/2016-1-18-C++%E4%B8%ADset%E5%92%8Cget%E7%9A%84%E7%AE%80%E5%8D%95%E6%96%B9%E5%BC%8F/" data-id="ckqhkhszn000xuavqd04i6tkk" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2015-11-20-C++内存对齐" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/public/2015/11/20/2015-11-20-C++%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90/" class="article-date">
  <time datetime="2015-11-20T02:06:05.000Z" itemprop="datePublished">2015-11-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/public/categories/%E6%9C%AA%E5%88%86%E7%B1%BB/">未分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/public/2015/11/20/2015-11-20-C++%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90/">C++内存对齐</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><pre><code>`
#pragma pack(push)
#pragma pack(n)
#pragma pack(show)
struct A
&#123;
    char     c;     //1byte
    double   d;     //8byte
    short    s;     //2byte
    int      i;     //4byte
&#125;;
#pragma pack(pop)
#pragma pack(show)
int main(int argc, char* argv[])
&#123;
    A a;
    printf(&quot;A length: %d\n&quot;,sizeof(A));
    printf(&quot;a.c:%10d\na.d:%10d\na.s:%10d\na.i:%10d\n&quot;,&amp;a.c, &amp;a.d, &amp;a.s, &amp;a.i);
    return 0;
&#125;
`
</code></pre><h1 id="n-1"><a href="#n-1" class="headerlink" title="n = 1"></a>n = 1</h1><p>内存对齐的结果为1，相当于不进行内存对齐，一些协议的设计可能会迫使我们修改n为1，<br>结果如下：</p>
<pre><code>A length: 15
a.c:  11795164
a.d:  11795165
a.s:  11795173
a.i:  11795175
</code></pre><p>其中，这里的4913360不一定是2、4或者8的倍数。</p>
<h1 id="n-2"><a href="#n-2" class="headerlink" title="n = 2"></a>n = 2</h1><p>结果如下：</p>
<pre><code>A length: 16
a.c:  12516948
a.d:  12516950
a.s:  12516958
a.i:  12516960
</code></pre><h1 id="n-3"><a href="#n-3" class="headerlink" title="n = 3"></a>n = 3</h1><p>编译器警告：warning C4086: 杂注参数应为“1”、“2”、“4”、“8”或者“16”<br>结果是：</p>
<pre><code>A length: 24
a.c:   9959560
a.d:   9959568
a.s:   9959576
a.i:   9959580
</code></pre><p>所以，最好取n为2的幂（此时，编译器以默认值#pragma pack(8)对齐）</p>
<h1 id="n-4"><a href="#n-4" class="headerlink" title="n = 4"></a>n = 4</h1><p>结果如下：</p>
<pre><code>A length: 20
a.c:  12516320
a.d:  12516324
a.s:  12516332
a.i:  12516336
</code></pre><h1 id="n-8"><a href="#n-8" class="headerlink" title="n = 8"></a>n = 8</h1><p>结果如下：</p>
<pre><code>A length: 24
a.c:  17300184
a.d:  17300192
a.s:  17300200
a.i:  17300204
</code></pre><h1 id="当注释内存对齐指令时"><a href="#当注释内存对齐指令时" class="headerlink" title="当注释内存对齐指令时"></a>当注释内存对齐指令时</h1><p>//#pragma   pack(n)</p>
<p>结果</p>
<pre><code>A length: 24
a.c:   8453680
a.d:   8453688
a.s:   8453696
a.i:   8453700
</code></pre><p>所以 如果不指定内存对齐，或者内存对齐不是2的幂次时，<br>编译器给出默认值<br><code>#pragma   pack(8)</code><br>另外，当n取值不合适时，可能需要2次寻址</p>
<p>注：</p>
<p>Windows 8.1 Pro x64 bit</p>
<p>用于 80x86 的 Microsoft (R) 32 位 C/C++ 优化编译器 16.00.30319.01 版</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://johzzy.github.io/2015/11/20/2015-11-20-C++%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90/" data-id="ckqhkhszi000luavq8nm90t9k" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2015-11-15-miniseed-note" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/public/2015/11/15/2015-11-15-miniseed-note/" class="article-date">
  <time datetime="2015-11-15T07:06:05.000Z" itemprop="datePublished">2015-11-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/public/categories/%E6%9C%AA%E5%88%86%E7%B1%BB/">未分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/public/2015/11/15/2015-11-15-miniseed-note/">Mini-Seed笔记</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>下载libmseed代码库</p>
<pre><code>https://seiscode.iris.washington.edu/projects/libmseed/files
</code></pre><p>将 miniseed 数据流转化为 MSRecord 结构</p>
<pre><code>// 引入头文件
#include &quot;libmseed.h&quot;
// 初始化一个 MSRecord
MSRecord *msr = msr_init(NULL);
/* 标注1 */
// 尝试Unpack，如果 retcode == MS_NOERROR，则成功，相应信息保存在 msr 中
int retcode = msr_unpack((char *)mseed_buffer, mseed_buffer_length, &amp;msr, true, 1);
// 从 msr 获取信息
char* network = msr-&gt;network;
char* station = msr-&gt;station;
char* channel = msr-&gt;channel;
char* location = msr-&gt;location;
char* starttime = msr-&gt;starttime;
char* samprate = msr-&gt;samprate;

unsigned int numsamples =  msr-&gt;numsamples;
char sampletype = msr-&gt;sampletype;

void * datasamples = msr-&gt;datasamples;

// 释放MSRecord
msr_free(&amp;msr);
</code></pre><p>标注</p>
<pre><code>如果mseed使用的是国家标准
在 `标注1` 处可能需要修正 mseed 数据流，原因是在libmseed.h中有一个宏定义检查

    #define MS_ISVALIDHEADER(X) (                               \
      (isdigit ((int) *(X))   || *(X)   == &apos; &apos; || !*(X) )   &amp;&amp;  \
      (isdigit ((int) *(X+1)) || *(X+1) == &apos; &apos; || !*(X+1) ) &amp;&amp;  \
      (isdigit ((int) *(X+2)) || *(X+2) == &apos; &apos; || !*(X+2) ) &amp;&amp;  \
      (isdigit ((int) *(X+3)) || *(X+3) == &apos; &apos; || !*(X+3) ) &amp;&amp;  \
      (isdigit ((int) *(X+4)) || *(X+4) == &apos; &apos; || !*(X+4) ) &amp;&amp;  \
      (isdigit ((int) *(X+5)) || *(X+5) == &apos; &apos; || !*(X+5) ) &amp;&amp;  \
      MS_ISDATAINDICATOR(*(X+6)) &amp;&amp;                             \
      (*(X+7) == &apos; &apos; || *(X+7) == &apos;\0&apos;) &amp;&amp;                      \
      (int)(*(X+24)) &gt;= 0 &amp;&amp; (int)(*(X+24)) &lt;= 23 &amp;&amp;            \
      (int)(*(X+25)) &gt;= 0 &amp;&amp; (int)(*(X+25)) &lt;= 59 &amp;&amp;            \
      (int)(*(X+26)) &gt;= 0 &amp;&amp; (int)(*(X+26)) &lt;= 60 )

修正的方式可以将mseed_buffer的前6个字节置为 0(ascii 0, 不是 &apos;0&apos;)，之前注意保存副本。

此外，可能会遇到大小端的问题
</code></pre><p>大小端转换</p>
<pre><code>#define BigtoLittle16(A) ((((u16)(A) &amp; 0xff00) &gt;&gt; 8) | (((u16)(A) &amp; 0x00ff) &lt;&lt; 8))
#define BigtoLittle32(A) ((((u32)(A) &amp; 0xff000000) &gt;&gt; 24) | (((u32)(A) &amp; 0x00ff0000) &gt;&gt; 8) | (((u32)(A) &amp; 0x0000ff00) &lt;&lt; 8)  | (((u32)(A) &amp; 0x000000ff) &lt;&lt; 24))
</code></pre><p>另外，可能需要在设计数据结构时，注意内存对齐，解决的方法是 修改数据结构，或者 添加编译器指令 </p>
<pre><code>#pragma   pack(n)
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://johzzy.github.io/2015/11/15/2015-11-15-miniseed-note/" data-id="ckqhkhszf000iuavqdz8laa2e" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2015-1-26-计算A文件相对B文件的路径" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/public/2015/01/22/2015-1-26-%E8%AE%A1%E7%AE%97A%E6%96%87%E4%BB%B6%E7%9B%B8%E5%AF%B9B%E6%96%87%E4%BB%B6%E7%9A%84%E8%B7%AF%E5%BE%84/" class="article-date">
  <time datetime="2015-01-22T07:53:41.000Z" itemprop="datePublished">2015-01-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/public/categories/%E6%9C%AA%E5%88%86%E7%B1%BB/">未分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/public/2015/01/22/2015-1-26-%E8%AE%A1%E7%AE%97A%E6%96%87%E4%BB%B6%E7%9B%B8%E5%AF%B9B%E6%96%87%E4%BB%B6%E7%9A%84%E8%B7%AF%E5%BE%84/">计算A文件相对B文件的路径</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>以前写的代码，今天发一下</p>
<pre><code>/*************************************************************************
    &gt;    File Name: relative_path.cpp
    &gt;       Author: johzzy
    &gt;        Email: hellojinqiang@gmail.com
    &gt; Created Time: Thu 13 Nov 2014 01:59:18 AM CST
    &gt;      Compile: g++ relative_path.cpp -std=c++14
 ************************************************************************/

#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;vector&gt;
#include &lt;sstream&gt;

using namespace std;

auto split(const string &amp;s, const char delim = &apos; &apos;)
&#123;
    stringstream ss(s);
    string item;
    vector&lt;string&gt; elems;

    while(getline(ss, item, delim) != NULL)
    &#123;
        elems.push_back(item);
    &#125;
    return  elems;
&#125;

int main(void)
&#123;
    string a, b;
    cout &lt;&lt; &quot;Please Enter the Absolute Path of the File!&quot; &lt;&lt; endl; 
    cout &lt;&lt; &quot;a = &quot;;
    cin &gt;&gt; a;
    cout &lt;&lt; &quot;b = &quot;;
    cin &gt;&gt; b;

    auto diffpath = [](const string &amp;a, const string &amp;b) &#123;
        int k = 0;
        for (int i=0; i&lt; a.length() &amp;&amp; i&lt;b.length() &amp;&amp; a[i] == b[i]; ++i)
            if (a[i] == &apos;/&apos;) k=i;
        return k+1;
    &#125;;

    int index = diffpath(a, b);

    a = a.substr(index);
    b = b.substr(index);

    auto vecta = split(a, &apos;/&apos;);
    auto vectb = split(b, &apos;/&apos;);

    string a_path_b = &quot;&quot;; //a relative to b path
    string b_path_a = &quot;&quot;; //b relative to a path

    for (int i=1; i&lt;vecta.size(); ++i)
        a_path_b += &quot;../&quot;;
    a_path_b += a;

    for(int i=1; i&lt;vectb.size(); ++i)
        b_path_a += &quot;../&quot;;
    b_path_a += b;

    cout &lt;&lt; &quot;a relative to b path: &quot; &lt;&lt; a_path_b &lt;&lt; endl;
    cout &lt;&lt; &quot;b relative to a path: &quot; &lt;&lt; b_path_a &lt;&lt; endl;

    return 0;
&#125;
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://johzzy.github.io/2015/01/22/2015-1-26-%E8%AE%A1%E7%AE%97A%E6%96%87%E4%BB%B6%E7%9B%B8%E5%AF%B9B%E6%96%87%E4%BB%B6%E7%9A%84%E8%B7%AF%E5%BE%84/" data-id="ckqhkhsza000auavq27eggk5s" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/public/tags/C/" rel="tag">C++</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2015-1-20-python-tree" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/public/2015/01/20/2015-1-20-python-tree/" class="article-date">
  <time datetime="2015-01-19T23:23:41.000Z" itemprop="datePublished">2015-01-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/public/categories/%E6%9C%AA%E5%88%86%E7%B1%BB/">未分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/public/2015/01/20/2015-1-20-python-tree/">Python Tree</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <pre><code>#!/usr/bin/env python
#    -*-coding: utf-8-*-     
#    File Name: tree
#       Author: johzzy
#        Email: hellojinqiang@gmail.com
# Created Time: Tue 20 Jan 2015 10:17:03 PM CST

import sys
import os

DEBUG = False
CLEAN = False
ALL = False

def lsall(dir, space = &quot;&quot;):
    dirname = dir
    global CLEAN
    if CLEAN and not os.listdir(dirname):
        os.rmdir(dirname)
        return

    dirs = filter(lambda x: ALL or x[0] != &apos;.&apos;, os.listdir(dirname))
    for item in dirs:
        if os.path.isdir(os.path.join(dirname, item)):
            subspace = space + &quot;|  &quot;
            print &quot;%s%s&quot; % (subspace, item)
            lsall(os.path.join(dirname, item), subspace)
        else:
            subspace = space + &quot;|--&quot;
            print &quot;%s%s&quot; % (subspace, item)


def main(args):
    for arg in filter(lambda x: os.path.exists(x), args):
        print arg
        lsall(arg, &quot;&quot;)

def help():
    print &apos;&apos;&apos;
Usage:
1) tree 
    default dir is your home directory
2) tree demodir
    print all files in demodir
3) tree demo1 demo2 demo3 ...
    print all files in these directories
4) tree --help or tree -h
    print tree Usage
5) tree --clean or tree -c
    print all file(s) in directory(s) and delete empty directory

version: 0.03
 author: Johnny Wong
   date: 2015-01-20
    &apos;&apos;&apos;

if __name__ == &quot;__main__&quot;:
    if len(sys.argv) &gt; 1:
        args = sys.argv[1:]
    else:
        args = [os.getcwd()]

    if &apos;--help&apos; in args or &apos;-h&apos; in args:
        help()
        exit(0)

    if &apos;--clean&apos; in args:
        CLEAN = True
        args.remove(&apos;--clean&apos;)
    if &apos;-c&apos; in args:
        CLEAN = True
        args.remove(&apos;-c&apos;)

    if &apos;--all&apos; in args:
        ALL = True
        args.remove(&apos;--all&apos;)
    if &apos;-a&apos; in args:
        ALL = True
        args.remove(&apos;-a&apos;)

    if DEBUG:
        args = [&apos;/home/johzzy/courses&apos;]

    main(args)
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://johzzy.github.io/2015/01/20/2015-1-20-python-tree/" data-id="ckqhkhsz70006uavq32b2cffz" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/public/tags/Python/" rel="tag">Python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2015-1-14-python-发送邮件" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/public/2015/01/14/2015-1-14-python-%E5%8F%91%E9%80%81%E9%82%AE%E4%BB%B6/" class="article-date">
  <time datetime="2015-01-14T06:23:41.000Z" itemprop="datePublished">2015-01-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/public/categories/%E6%9C%AA%E5%88%86%E7%B1%BB/">未分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/public/2015/01/14/2015-1-14-python-%E5%8F%91%E9%80%81%E9%82%AE%E4%BB%B6/">Python 发送邮件</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <pre><code>#!/bin/python
#    -*-coding: utf-8-*-     
#    File Name: send_mail.py
#       Author: johzzy
#        Email: hellojinqiang@gmail.com
# Created Time: Wed 07 Jan 2015 02:36:04 PM CST

import smtplib  
from email.mime.text import MIMEText  

mailto_list     = [&apos;Inboxs@inboxmail&apos;]         #收件箱
user             = &quot;OutboxName&quot;              #邮件署名 可省略为&quot;&quot;
mail_user         = &quot;Outbox&quot;                    #发件箱的用户名
mail_postfix     = &quot;outboxmail&quot;              #发件箱的后缀
mail_pass         = &quot;OutboxLoginPassword&quot;       #发件箱的登陆密码 
mail_host         = &quot;smtp.outboxmail&quot;          #发件箱的服务器

def send_mail(to_list,sub,content):  
    me = user+&quot;&lt;&quot;+mail_user+&quot;@&quot;+mail_postfix+&quot;&gt;&quot;                   #    OutboxName&lt;Outbox@outboxmail&gt;
    msg = MIMEText(content,_subtype=&apos;plain&apos;,_charset=&apos;utf8&apos;)  
    msg[&apos;Subject&apos;] = sub  
    msg[&apos;From&apos;] = me  
    msg[&apos;To&apos;] = &quot;;&quot;.join(to_list)  
    try:  
        server = smtplib.SMTP()  
        server.connect(mail_host)  
        server.login(mail_user,mail_pass)  
        server.sendmail(me, to_list, msg.as_string())  
        server.close()  
        return True  
    except Exception, e:  
        print str(e)  
        return False  

if __name__ == &apos;__main__&apos;:  
    if send_mail(mailto_list,&quot;hello&quot;,&quot;hello world！&quot;):  
        print &quot;发送成功&quot;  
    else:  
        print &quot;发送失败&quot;
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://johzzy.github.io/2015/01/14/2015-1-14-python-%E5%8F%91%E9%80%81%E9%82%AE%E4%BB%B6/" data-id="ckqhkhsz60005uavqfyzy7eqc" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/public/tags/Python/" rel="tag">Python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2015-1-14-python-ssh传输文件" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/public/2015/01/14/2015-1-14-python-ssh%E4%BC%A0%E8%BE%93%E6%96%87%E4%BB%B6/" class="article-date">
  <time datetime="2015-01-13T23:23:41.000Z" itemprop="datePublished">2015-01-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/public/categories/%E6%9C%AA%E5%88%86%E7%B1%BB/">未分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/public/2015/01/14/2015-1-14-python-ssh%E4%BC%A0%E8%BE%93%E6%96%87%E4%BB%B6/">Python SSH 传输文件</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <pre><code>#!/usr/bin/env python
#    -*-coding: utf-8-*-     
#    File Name: ssh_test.py
#       Author: johzzy
#        Email: hellojinqiang@gmail.com
# Created Time: Tue 13 Jan 2015 07:18:41 PM CST

import pexpect  

import subprocess

class rsync_tool:
    def __init__(self):
        self.user = &apos;johnny&apos;
        self.host = &apos;172.16.123.128&apos;
        self.remote_file = &apos;/tmp/joke&apos;
        self.local_file = &apos;/tmp/me&apos;
        self.passwd_file = &apos;/tmp/johnny.pwd&apos;

        self.fhandler = open(self.passwd_file, &apos;r&apos;)
        self.passwd = self.fhandler.read()
        self.fhandler.close()

    def download(self, remote_file, local_file):
        getfile = &apos;rsync %s@%s:%s %s&apos; % (self.user, self.host, remote_file, local_file)

        child = pexpect.spawn(getfile)
        child.expect(&quot;password: &quot;)
        child.sendline(self.passwd)
        child.read()

    def upload(self, local_file, remote_file):
        sendfile = &apos;rsync %s %s@%s:%s&apos; % (local_file, self.user, self.host, remote_file)

        child = pexpect.spawn(sendfile)
        child.expect(&quot;password: &quot;)
        child.sendline(self.passwd)
        child.read()

    def test(self):
        subprocess.call(&quot;rsync  --password-file=&apos;/tmp/johnny.pwd&apos; johnny@172.16.123.128:/tmp/joke /tmp/joke&quot;)

    def main(self):
        self.upload(&quot;/tmp/hello.txt&quot;, &quot;/tmp/world.txt&quot;)
        self.download(&quot;/tmp/world.txt&quot;, &quot;/tmp/hello&quot;)

if __name__ == &quot;__main__&quot;:
    r = rsync_tool()
    r.main()
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://johzzy.github.io/2015/01/14/2015-1-14-python-ssh%E4%BC%A0%E8%BE%93%E6%96%87%E4%BB%B6/" data-id="ckqhkhszb000buavqb9zach7c" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/public/tags/Python/" rel="tag">Python</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/public/">&amp;laquo; Prev</a><a class="page-number" href="/public/">1</a><span class="page-number current">2</span><a class="page-number" href="/public/page/3/">3</a><a class="extend next" rel="next" href="/public/page/3/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/public/categories/%E6%9C%AA%E5%88%86%E7%B1%BB/">未分类</a><span class="category-list-count">16</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/public/tags/C/" rel="tag">C++</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/public/tags/FTP/" rel="tag">FTP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/public/tags/Python/" rel="tag">Python</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/public/tags/ffmpeg/" rel="tag">ffmpeg</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/public/tags/lambda/" rel="tag">lambda</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/public/tags/shell/" rel="tag">shell</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/public/tags/simulcast/" rel="tag">simulcast</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/public/tags/webrtc/" rel="tag">webrtc</a><span class="tag-list-count">3</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/public/archives/2021/07/">July 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/public/archives/2021/06/">June 2021</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/public/archives/2018/05/">May 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/public/archives/2016/08/">August 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/public/archives/2016/07/">July 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/public/archives/2016/06/">June 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/public/archives/2016/04/">April 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/public/archives/2016/01/">January 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/public/archives/2015/11/">November 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/public/archives/2015/01/">January 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/public/archives/2014/11/">November 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/public/archives/2014/02/">February 2014</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/public/2021/07/23/how-to-add-custom-field-in-webrtc-sdp/">How to add custom field in WebRTC SDP</a>
          </li>
        
          <li>
            <a href="/public/2021/07/22/how-to-support-simulcast-in-srs/">How to support Simulcast in SRS</a>
          </li>
        
          <li>
            <a href="/public/2021/06/28/a-mac-bug-about-udp-port-triggered-by-srs/">a mac bug about udp port triggered by srs</a>
          </li>
        
          <li>
            <a href="/public/2021/06/23/simulcast-layer-state-control/">simulcast layer state control</a>
          </li>
        
          <li>
            <a href="/public/2021/06/18/simulcast-support-in-srs/">simulcast support in srs</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 johzzy<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/public/" class="mobile-nav-link">Home</a>
  
    <a href="/public/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/public/fancybox/jquery.fancybox.css">

  
<script src="/public/fancybox/jquery.fancybox.pack.js"></script>




<script src="/public/js/script.js"></script>




  </div>
</body>
</html>