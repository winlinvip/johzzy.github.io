<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Johzzy Pages</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="some code, some note.">
<meta property="og:type" content="website">
<meta property="og:title" content="Johzzy Pages">
<meta property="og:url" content="https://johzzy.github.io/index.html">
<meta property="og:site_name" content="Johzzy Pages">
<meta property="og:description" content="some code, some note.">
<meta property="og:locale">
<meta property="article:author" content="johzzy">
<meta name="twitter:card" content="summary">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/public/css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/public/" id="logo">Johzzy Pages</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/public/">Home</a>
        
          <a class="main-nav-link" href="/public/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://johzzy.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-2018-05-13-ffmpeg-scale-samples" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/public/2018/05/13/2018-05-13-ffmpeg-scale-samples/" class="article-date">
  <time datetime="2018-05-13T09:49:16.000Z" itemprop="datePublished">2018-05-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/public/2018/05/13/2018-05-13-ffmpeg-scale-samples/">ffmpeg scale samples</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>ffmpeg 音量增益</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// https://www.ffmpeg.org/doxygen/2.7/af__volume_8c_source.html</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// static inline int16_t av_clip_int16(int a)</span></span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//     if ((a+0x8000U) &amp; ~0xFFFF) return (a&gt;&gt;31) ^ 0x7FFF;</span></span><br><span class="line"><span class="comment">//     else                      return a;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">scaleSamplesS16Volume</span><span class="params">(<span class="keyword">uint8_t</span> *dst, <span class="keyword">int</span> nb_samples, <span class="keyword">double</span> adjustVolumeValue)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int16_t</span> *smp_dst       = (<span class="keyword">int16_t</span> *)dst;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> volume = (<span class="keyword">int</span>)(adjustVolumeValue * <span class="number">256</span> + <span class="number">0.5</span>);</span><br><span class="line">    <span class="comment">// volume &lt; if (vol-&gt;volume_i &lt; 0x1000000)</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\r====%d %lf   &quot;</span>, volume, adjustVolumeValue);</span><br><span class="line">    <span class="keyword">if</span> (volume &lt; <span class="number">0x1000000</span>) &#123;</span><br><span class="line">        <span class="comment">// vol-&gt;scale_samples = scale_samples_u8_small;</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nb_samples; ++i) &#123;</span><br><span class="line">            smp_dst[i] = av_clip_int16((smp_dst[i] * volume + <span class="number">128</span>) &gt;&gt; <span class="number">8</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// vol-&gt;scale_samples = scale_samples_u8;</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nb_samples; ++i) &#123;</span><br><span class="line">            smp_dst[i] = av_clip_int16(((<span class="keyword">int64_t</span>)smp_dst[i] * volume + <span class="number">128</span>) &gt;&gt; <span class="number">8</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://johzzy.github.io/2018/05/13/2018-05-13-ffmpeg-scale-samples/" data-id="ckpz90v5s001k7jvq573c4big" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/public/tags/ffmpeg/" rel="tag">ffmpeg</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2016-08-31-fstab-shell-script" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/public/2016/08/31/2016-08-31-fstab-shell-script/" class="article-date">
  <time datetime="2016-08-31T09:56:02.000Z" itemprop="datePublished">2016-08-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/public/2016/08/31/2016-08-31-fstab-shell-script/">一个简单的命令</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>注释或恢复 /dev/sda2            /media/video1            ext4    defaults    0 0</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">fstab=<span class="string">&quot;fstab&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">removefs</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">targetfile=<span class="string">&quot;<span class="variable">$fstab</span>&quot;</span></span><br><span class="line">sed -i <span class="string">&#x27;s/^\(\/dev\/sd.*\/media\/video[1234].*ext4.*defaults.*\)/\#\1/g&#x27;</span> <span class="variable">$targetfile</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">restorefs</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">targetfile=<span class="string">&quot;<span class="variable">$fstab</span>&quot;</span></span><br><span class="line">sed -i <span class="string">&#x27;s/^#\(\/dev\/sd.*\/media\/video[1234].*ext4.*defaults.*\)/\1/g&#x27;</span> <span class="variable">$targetfile</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">usage</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&quot;./rmfstab [restore|help]&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">## main entry</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line">restore|reduce|r|no|not|1)</span><br><span class="line">	restorefs;;</span><br><span class="line"><span class="built_in">help</span>|--<span class="built_in">help</span>|h|-h|0)</span><br><span class="line">	usage;;</span><br><span class="line">*)</span><br><span class="line">	removefs;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://johzzy.github.io/2016/08/31/2016-08-31-fstab-shell-script/" data-id="ckpz90v5p001b7jvq9mae5vhb" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2016-08-29-单引号’字符串‘" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/public/2016/08/29/2016-08-29-%E5%8D%95%E5%BC%95%E5%8F%B7%E2%80%99%E5%AD%97%E7%AC%A6%E4%B8%B2%E2%80%98/" class="article-date">
  <time datetime="2016-08-29T02:23:40.000Z" itemprop="datePublished">2016-08-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/public/categories/未分类/">未分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/public/2016/08/29/2016-08-29-%E5%8D%95%E5%BC%95%E5%8F%B7%E2%80%99%E5%AD%97%E7%AC%A6%E4%B8%B2%E2%80%98/">单引号&#39;字符串&#39;</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>阅读项目发现的一段代码</p>
<pre><code>struct PACK_HEAD // 新结构，与类型长度无关
&#123;
    ULONG synch   :16;        //同步字节
    ULONG version : 8;        //协议版本
    ULONG type    : 8;        //包类型
    ULONG sn      :32;        //包序列号
    ULONG fun     :32;        //主功能号
    ULONG sub     :32;        //子功能号
    ULONG datalen :32;        //数据域总长
    ULONG retcode :32;        //返回码
    ULONG total   :16;        //包的分片总数
    ULONG index   :16;        //包的分片序号,从0开始
    ULONG patch   :24;        //补位字节,使结构长度适应4字节对齐方式
    ULONG checksum: 8;        //异或校验和
&#125; m_head;
...
if(this-&gt;m_head.sub == &apos;REC&apos;)              
&#123;
    WriteDebugLog(&quot;录像查询: [%s]&quot;, pTask-&gt;m_body.data);    
        todo_other(...);            
&#125;

this-&gt;m_head.sub == &apos;REC&apos; 这句是什么意思
&apos;REC&apos; 是什么类型
</code></pre><p>查询资料得知这是一种数据表示，测试代码如下</p>
<pre><code>#include &lt;cstdio&gt;
#include &lt;cstdlib&gt;
#include &lt;ctime&gt;

#define WriteErrorLog(format, ...) \
    do &#123;\
    time_t nowtime = time(NULL); struct tm* local = localtime(&amp;nowtime); char timestramp[80] = &#123;0&#125;; strftime(timestramp, 80, &quot;%Y-%m-%d %H:%M:%S&quot;, local);\
    fprintf(stderr, &quot;%s [ERROR] %s(%d): &quot;format&quot;\n&quot;, timestramp, __FUNCTION__ , __LINE__, __VA_ARGS__); \
    &#125; while(0)


int main()
&#123;    
    int ab = &apos;AB&apos;;
    int a = &apos;A&apos;;
    int b = &apos;B&apos;;
    int a_b = (&apos;A&apos; &lt;&lt; 8) + &apos;B&apos;;

    WriteErrorLog(&quot;A:%d, B:%d&quot;, a, b);
    WriteErrorLog(&quot;ab: %d&quot;, ab);
    WriteErrorLog(&quot;a_b: %d&quot;, a_b);

    system(&quot;pause&quot;);
    return 0;
&#125;
</code></pre><p><img src="20160829101359.png," alt="cmd" title="cmd"></p>
<p>‘AB’ 与 12 类比:</p>
<pre><code>&apos;AB&apos; 表示  &apos;A&apos; * 2^8 + &apos;B&apos;
12   表示 1 * 10^1 + 2
</code></pre><p>注意</p>
<pre><code>data_type var = &apos;ABCD&apos;;
这里 &apos;ABCD&apos; 需要在 data_type (char short int long) 的取值范围内, 不可越界.
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://johzzy.github.io/2016/08/29/2016-08-29-%E5%8D%95%E5%BC%95%E5%8F%B7%E2%80%99%E5%AD%97%E7%AC%A6%E4%B8%B2%E2%80%98/" data-id="ckpz90v5o00167jvqdof9ai67" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2016-07-28-centos_upgrade_python" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/public/2016/07/28/2016-07-28-centos_upgrade_python/" class="article-date">
  <time datetime="2016-07-28T01:46:14.000Z" itemprop="datePublished">2016-07-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/public/categories/未分类/">未分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/public/2016/07/28/2016-07-28-centos_upgrade_python/">CentOS 升级 Python 整理记录</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>CentOS 升级 Python 整理记录</p>
<pre><code>CentOS 版本: 6.0 (x64)
Python 原版本： 2.6.5
Python 升级版本：2.7.12
Python 2.7.12 链接： https://www.python.org/ftp/python/2.7.12/Python-2.7.12.tar.xz
</code></pre><p>执行过程</p>
<pre><code># 预先准备
cd /usr/bin
python --version

# 拷贝 python2.6.5 副本
cp python python2.6.5  # 安全起见(1)

# 修改下述三个文件开头, 指定 python 解释器为 /usr/bin/python2.6.5
# 原因是它们不支持 python27
vim /usr/bin/yum
vim /usr/bin/ibus-setup
vim /usr/libexec/ibus-ui-gtk

# 下载安装
wget https://www.python.org/ftp/python/2.7.12/Python-2.7.12.tar.xz
tar xf Python-2.7.12.tar.xz
cd Python-2.7.12
./configure
make all
make install
make clean
make distclean
/usr/local/bin/python2.7 --version
rm /usr/bin/python # 呼应上文命令(1)
ln -s /usr/local/bin/python2.7 /usr/bin/python

# 安装后
## 修复 或 安装 pip
yum install python-pip
pip install --upgrade setuptools
wget --no-check-certificate  https://raw.github.com/pypa/pip/master/contrib/get-pip.py # 命令(3)
wget --no-check-certificate  https://bootstrap.pypa.io/get-pip.py                      # 命令(4)

# 尝试运行 命令 (3, 4) 下载的脚本, 至此 pip 修复完成 
python get-pip.py
pip --version
pip install bs4
pip install requests

# 小工具
yum install dos2unix lrzsz
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://johzzy.github.io/2016/07/28/2016-07-28-centos_upgrade_python/" data-id="ckpz90v5o00147jvq8ntp6k80" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2016-07-28-centos_upgrade_gcc" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/public/2016/07/28/2016-07-28-centos_upgrade_gcc/" class="article-date">
  <time datetime="2016-07-28T01:45:50.000Z" itemprop="datePublished">2016-07-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/public/categories/未分类/">未分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/public/2016/07/28/2016-07-28-centos_upgrade_gcc/">CentOS 升级 GCC 整理记录</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>CentOS 升级 GCC 整理记录</p>
<pre><code>CentOS 版本: 6.0 (x64)
GCC 原版本： 4.4.7
GCC 升级版本：4.8.5
GCC 4.8.5 链接： https://ftp.gnu.org/gnu/gcc/gcc-4.8.5/gcc-4.8.5.tar.gz
</code></pre><p>执行过程</p>
<pre><code>wget https://ftp.gnu.org/gnu/gcc/gcc-4.8.5/gcc-4.8.5.tar.gz
tar zxf gcc-4.8.5.tar.gz
cd gcc-4.8.5

yum install gcc g++
yum install glibc-static
yum install cloog-ppl gmp-devel

wget ftp://gcc.gnu.org/pub/gcc/infrastructure/isl-0.11.1.tar.bz2
tar jxf isl-0.11.1.tar.bz2
cd isl-0.11.1
./configure
make
make install

cd ..
./contrib/download_prerequisites
mkdir build
cd build
../configure --prefix=/usr --enable-languages=c,c++ --disable-multilib
make -j4
make install
</code></pre><p>GCC 4.8.5 支持 C++11 的部分特性</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://johzzy.github.io/2016/07/28/2016-07-28-centos_upgrade_gcc/" data-id="ckpz90v5n00107jvq0jfs89xc" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2016-6-6-browser-plugin" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/public/2016/06/06/2016-6-6-browser-plugin/" class="article-date">
  <time datetime="2016-06-06T04:40:05.000Z" itemprop="datePublished">2016-06-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/public/categories/未分类/">未分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/public/2016/06/06/2016-6-6-browser-plugin/">浏览器插件</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Chrome 插件</p>
<pre><code>1. ADfree.Player.Online
一款屏蔽国内主要视频网站部分视频广告的扩展。

2. Allow Copy
解除一些网站不允许的右键复制

3. Bookmark Manager
来自 google

4. ChaZD
ChaZD 查字典，简洁易用的英汉字典扩展程序，支持划词哦:)

5. crxMouse Chrome Gestures
Boost browsing productivity with your fingertips - Mouse Gestures, Super Drag, Wheel Gestures, Rocker Gestures.
(不经常使用, 更多使用 vim 插件)

6. Disconnect
Make the web faster, more private, and more secure.
(google 已跪, 可以使用 duckduckgo)

7. Ghostery
Enjoy a faster, safer and cleaner browsing experience.
(用于屏蔽网页的一些信息跟踪)

8. Google Art Project
Art Project masterpieces from Google Cultural Institute in your browser tabs
(还行)

9. HTTPS Everywhere
Encrypt the Web! Automatically use HTTPS security on many sites.
(提高安全姿势)

10. ImprovedTube - YouTube Extension
Improves YouTube&apos;s functions and site with Limited Permissions. Auto HD, Resize, Annotations, Playback Speed and more.
(美化youtube, 不及 Magic Actions)

11. iReader
View news stories and other articles in a very easy to read, clutter-free, scrollable display.
(阅读模式)

12. Magic Actions for YouTube™
Enhance your YouTube watching experience! Auto HD, Ad Block, Cinema Mode, Mouse Wheel Volume Control, Screenshot...
(更加美化youtube)

13. Octotree
Code tree for GitHub and GitLab
(神器)

14. OneTab
Save up to 95% memory and reduce tab clutter
(节省资源)

15. Privacy Badger
Privacy Badger protects you from trackers as you surf the web!
(隐私安全)

16. Proxy SwitchyOmega
Manage and switch between multiple proxies quickly &amp; easily.
(科学上网)

17. Redirector
Automatically redirect pages based on user-defined rules. E.g. always redirect an article url to its printer-friendly version.

18. Remove Google Redirection
Prohibit click-tracking, and prevent url redirection when clicks on the result links in Google search page

19. scroll style
Like android&apos;s scroll bars .像android的滚动条

20. StopFingerprinting
Fingerprinting analysis extension.
(隐私安全, 不知是否有效)

21. Stylish
Restyle the web with Stylish, a user styles manager. Stylish lets you easily install themes and skins for many popular sites.
(神器, 自定义 css 样式)

22. Tampermonkey
The most popular userscript manager for Blink-based browsers
(神器, 自定义 js 样式)

23. The Great Suspender
Automatically suspends unused tabs to free up system resources
(节省资源, 配合 OneTab)

24. User-Agent Switcher for Google Chrome
User-Agent Switcher for Google Chrome switches between different user-agents.

25. Vimium
The Hacker&apos;s Browser. Vimium provides keyboard shortcuts for navigation and control in the spirit of Vim.
(神器, 已上瘾)

26. WebRTC Leak Prevent
Prevent WebRTC leaks, without blocking WebRTC.
(安全, 隐藏本地IP)

27. 买买买购物助手
(还没有使用)

28. 保护眼睛
阿姆斯特朗回旋喷气式阿姆斯特朗墨镜

29. 隐藏帖自动回复 (AutoReply 纯净版)
自动回复隐藏帖 (要求已登录, 改自同名 Chrome 插件, 版权归原作者所有)
</code></pre><p>Firefox</p>
<pre><code>ACVAA
Adblock Plus
Disconnect
Disconnect Search
Element Hiding Helper for Adblock Plus
FEBE
FoxyProxy Standard
Ghostery
Greasemonkey
HTTPS-Everywhere
NoScript
Omnibar
PopVideo
SmartVideo For YouTube
Vimperator
</code></pre><p>以下在破坏本文规则</p>
<p>PowerShell</p>
<pre><code>posh-git
PowerTab
PSCX
PsGet
PSReadline
</code></pre><p>Zsh</p>
<pre><code>git 
incr  
terminitor 
tmux
z 
zsh-history-substring-search
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://johzzy.github.io/2016/06/06/2016-6-6-browser-plugin/" data-id="ckpz90v6100207jvq7k2a58ib" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2016-4-13-my-string-format" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/public/2016/04/13/2016-4-13-my-string-format/" class="article-date">
  <time datetime="2016-04-13T09:57:35.000Z" itemprop="datePublished">2016-04-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/public/categories/未分类/">未分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/public/2016/04/13/2016-4-13-my-string-format/">一种字符串序列描述</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>将两个序列</p>
<pre><code>A = &#123;1, 4, 6, 8, 9&#125;
B = &#123;10, 11, 12, ...20&#125;
</code></pre><p>转为如下形式</p>
<pre><code>string a = &quot;1,4,6,8-9&quot;;
string b = &quot;10-20&quot;; 
</code></pre><p>`<br>QString SeriesEdit::FormatSeries(const QSet<int>&amp; series)<br>{<br>    QList<int> series_list = series.toList();<br>    qSort(series_list.begin(), series_list.end());</p>
<pre><code>int last = 0xffffffff;
bool match = false;

QString series_str;
for (QList&lt;int&gt;::iterator it = series_list.begin(); it != series_list.end(); ++it)
&#123;
    int var = *it;
    if (it == series_list.begin())
    &#123;
        series_str += QString::number(var);
    &#125;
    else if (last + 1 == var)
    &#123;
        series_str += &quot;-&quot;;
        match = true;
    &#125;
    else if (match)
    &#123;            
        series_str += QString::number(last) + &quot;,&quot; + QString::number(var);
        match = false;
    &#125;    
    else
    &#123;
        series_str += &quot;,&quot; + QString::number(var);
    &#125;
    last = *it;
&#125;
if (match)
&#123;
    series_str += QString::number(last);
&#125;

return series_str.split(&quot;-&quot;, QString::SkipEmptyParts).join(&quot;-&quot;);
</code></pre><p>}</p>
<p>`</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://johzzy.github.io/2016/04/13/2016-4-13-my-string-format/" data-id="ckpz90v5r001h7jvqdqycc49h" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2016-1-18-C++中set和get的简单方式" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/public/2016/01/18/2016-1-18-C++%E4%B8%ADset%E5%92%8Cget%E7%9A%84%E7%AE%80%E5%8D%95%E6%96%B9%E5%BC%8F/" class="article-date">
  <time datetime="2016-01-18T02:46:05.000Z" itemprop="datePublished">2016-01-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/public/categories/未分类/">未分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/public/2016/01/18/2016-1-18-C++%E4%B8%ADset%E5%92%8Cget%E7%9A%84%E7%AE%80%E5%8D%95%E6%96%B9%E5%BC%8F/">C++中set和get的简单方式</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在C#中, 有比较通用的set和get, 在C++中可以使用引用和访问限制符来简单处理,   具体如下</p>
<pre><code>`
#define SUCCESS 1 // #define SUCCESS 1
#define FAIL 0 // #define FAIL 0
#include &lt;iostream&gt;
int add(int a, int b) &#123; return a + b; &#125;
class A
&#123;
private:
    int a_;
    int b_;
public:
    const int&amp; a;
    const int&amp; b;
public:
    int x_;
    int y_;
    const int&amp; x;
    const int&amp; y;
    A()
    : a_(0), b_(0), x_(0), y_(0)
    , a(a_), b(b_), x(x_), y(y_)
    &#123;&#125;

    void print() &#123; 
        std::cout &lt;&lt; &quot;  a=&quot; &lt;&lt; a &lt;&lt; &quot;, a_=&quot; &lt;&lt; a_ 
              &lt;&lt; &quot;, b=&quot; &lt;&lt; b &lt;&lt; &quot;, b_=&quot; &lt;&lt; b_
              &lt;&lt; &quot;, x=&quot; &lt;&lt; x &lt;&lt; &quot;, x_=&quot; &lt;&lt; x_
              &lt;&lt; &quot;, y=&quot; &lt;&lt; y &lt;&lt; &quot;, y_=&quot; &lt;&lt; y_
                          &lt;&lt; &quot;.\n&quot;;
    &#125;
&#125;;

int  main()
&#123;
    int result = add(SUCCESS, FAIL);
    A a;
    a.x_ = 4;    // (1) 
    //a.x = 5;    // (2) 
    //a.a_ = 3; // (3)
    //a.a = 5;  // (4)
    a.y_ = a.x; // (5)
    // a.y = a.x; // (6)
    // a.a = a.y; // (7)    
    a.print();
    return 0;
&#125;
`
</code></pre><p>其中,</p>
<p>(1) <code>public int x_</code>, 跟全局变量的访问一样<br>(2) <code>a.x</code> 为 <code>public int&amp;</code> 类型, 指向<code>public int x_</code>, 这里相当于 <code>set</code><br>(3) error, <code>private int a_</code> 尝试修改私有变量的值<br>(4) error, <code>public const int&amp; y</code> 尝试修改<code>const</code>变量<br>(5) <code>a.x</code> 相当于<code>get</code>, 并修改 <code>y_</code><br>(6) <code>error</code>, <code>public const int&amp; y</code> 尝试修改<code>const</code>变量<br>(7) <code>error</code>, <code>a.x</code> 相当于<code>get</code>, <code>a.a</code> 尝试修改<code>const</code>变量  </p>
<p>对此，如果一个变量 <code>var</code> 是只读的，但是在对象构造时需要赋值, 可以参照如下方式</p>
<pre><code>class A 
&#123;
private:
    int var_;
public:
    const int&amp; var;
public:
    A(int a):var_(a)&#123;&#125;
    Foo() &#123; /*process var_*/ &#125;
&#125;;
</code></pre><p>于是, 在初始化是可以 <code>A a(5)</code>, 在<code>a</code>的内部, 仍然可以对 <code>var_</code> 做任何处理, 使用时 <code>a.var</code>, 而不必考虑<code>var</code>被外界修改的问题.</p>
<p>(完)</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://johzzy.github.io/2016/01/18/2016-1-18-C++%E4%B8%ADset%E5%92%8Cget%E7%9A%84%E7%AE%80%E5%8D%95%E6%96%B9%E5%BC%8F/" data-id="ckpz90v5q001d7jvq36h96puf" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2015-11-20-C++内存对齐" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/public/2015/11/20/2015-11-20-C++%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90/" class="article-date">
  <time datetime="2015-11-20T02:06:05.000Z" itemprop="datePublished">2015-11-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/public/categories/%E6%9C%AA%E5%88%86%E7%B1%BB/">未分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/public/2015/11/20/2015-11-20-C++%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90/">C++内存对齐</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><pre><code>`
#pragma pack(push)
#pragma pack(n)
#pragma pack(show)
struct A
&#123;
    char     c;     //1byte
    double   d;     //8byte
    short    s;     //2byte
    int      i;     //4byte
&#125;;
#pragma pack(pop)
#pragma pack(show)
int main(int argc, char* argv[])
&#123;
    A a;
    printf(&quot;A length: %d\n&quot;,sizeof(A));
    printf(&quot;a.c:%10d\na.d:%10d\na.s:%10d\na.i:%10d\n&quot;,&amp;a.c, &amp;a.d, &amp;a.s, &amp;a.i);
    return 0;
&#125;
`
</code></pre><h1 id="n-1"><a href="#n-1" class="headerlink" title="n = 1"></a>n = 1</h1><p>内存对齐的结果为1，相当于不进行内存对齐，一些协议的设计可能会迫使我们修改n为1，<br>结果如下：</p>
<pre><code>A length: 15
a.c:  11795164
a.d:  11795165
a.s:  11795173
a.i:  11795175
</code></pre><p>其中，这里的4913360不一定是2、4或者8的倍数。</p>
<h1 id="n-2"><a href="#n-2" class="headerlink" title="n = 2"></a>n = 2</h1><p>结果如下：</p>
<pre><code>A length: 16
a.c:  12516948
a.d:  12516950
a.s:  12516958
a.i:  12516960
</code></pre><h1 id="n-3"><a href="#n-3" class="headerlink" title="n = 3"></a>n = 3</h1><p>编译器警告：warning C4086: 杂注参数应为“1”、“2”、“4”、“8”或者“16”<br>结果是：</p>
<pre><code>A length: 24
a.c:   9959560
a.d:   9959568
a.s:   9959576
a.i:   9959580
</code></pre><p>所以，最好取n为2的幂（此时，编译器以默认值#pragma pack(8)对齐）</p>
<h1 id="n-4"><a href="#n-4" class="headerlink" title="n = 4"></a>n = 4</h1><p>结果如下：</p>
<pre><code>A length: 20
a.c:  12516320
a.d:  12516324
a.s:  12516332
a.i:  12516336
</code></pre><h1 id="n-8"><a href="#n-8" class="headerlink" title="n = 8"></a>n = 8</h1><p>结果如下：</p>
<pre><code>A length: 24
a.c:  17300184
a.d:  17300192
a.s:  17300200
a.i:  17300204
</code></pre><h1 id="当注释内存对齐指令时"><a href="#当注释内存对齐指令时" class="headerlink" title="当注释内存对齐指令时"></a>当注释内存对齐指令时</h1><p>//#pragma   pack(n)</p>
<p>结果</p>
<pre><code>A length: 24
a.c:   8453680
a.d:   8453688
a.s:   8453696
a.i:   8453700
</code></pre><p>所以 如果不指定内存对齐，或者内存对齐不是2的幂次时，<br>编译器给出默认值<br><code>#pragma   pack(8)</code><br>另外，当n取值不合适时，可能需要2次寻址</p>
<p>注：</p>
<p>Windows 8.1 Pro x64 bit</p>
<p>用于 80x86 的 Microsoft (R) 32 位 C/C++ 优化编译器 16.00.30319.01 版</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://johzzy.github.io/2015/11/20/2015-11-20-C++%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90/" data-id="ckpz90v5m000x7jvq0l50heo7" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2015-11-15-miniseed-note" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/public/2015/11/15/2015-11-15-miniseed-note/" class="article-date">
  <time datetime="2015-11-15T07:06:05.000Z" itemprop="datePublished">2015-11-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/public/categories/%E6%9C%AA%E5%88%86%E7%B1%BB/">未分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/public/2015/11/15/2015-11-15-miniseed-note/">Mini-Seed笔记</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>下载libmseed代码库</p>
<pre><code>`https://seiscode.iris.washington.edu/projects/libmseed/files`
</code></pre><p>将 miniseed 数据流转化为 MSRecord 结构</p>
<pre><code>`
// 引入头文件
#include &quot;libmseed.h&quot;
// 初始化一个 MSRecord
MSRecord *msr = msr_init(NULL);
/* 标注1 */
// 尝试Unpack，如果 retcode == MS_NOERROR，则成功，相应信息保存在 msr 中
int retcode = msr_unpack((char *)mseed_buffer, mseed_buffer_length, &amp;msr, true, 1);
// 从 msr 获取信息
char* network = msr-&gt;network;
char* station = msr-&gt;station;
char* channel = msr-&gt;channel;
char* location = msr-&gt;location;
char* starttime = msr-&gt;starttime;
char* samprate = msr-&gt;samprate;

unsigned int numsamples =  msr-&gt;numsamples;
char sampletype = msr-&gt;sampletype;

void * datasamples = msr-&gt;datasamples;

// 释放MSRecord
msr_free(&amp;msr);
`
</code></pre><p>标注</p>
<pre><code>如果mseed使用的是国家标准
在 `标注1` 处可能需要修正 mseed 数据流，原因是在libmseed.h中有一个宏定义检查
`
    #define MS_ISVALIDHEADER(X) (                               \
      (isdigit ((int) *(X))   || *(X)   == &apos; &apos; || !*(X) )   &amp;&amp;  \
      (isdigit ((int) *(X+1)) || *(X+1) == &apos; &apos; || !*(X+1) ) &amp;&amp;  \
      (isdigit ((int) *(X+2)) || *(X+2) == &apos; &apos; || !*(X+2) ) &amp;&amp;  \
      (isdigit ((int) *(X+3)) || *(X+3) == &apos; &apos; || !*(X+3) ) &amp;&amp;  \
      (isdigit ((int) *(X+4)) || *(X+4) == &apos; &apos; || !*(X+4) ) &amp;&amp;  \
      (isdigit ((int) *(X+5)) || *(X+5) == &apos; &apos; || !*(X+5) ) &amp;&amp;  \
      MS_ISDATAINDICATOR(*(X+6)) &amp;&amp;                             \
      (*(X+7) == &apos; &apos; || *(X+7) == &apos;\0&apos;) &amp;&amp;                      \
      (int)(*(X+24)) &gt;= 0 &amp;&amp; (int)(*(X+24)) &lt;= 23 &amp;&amp;            \
      (int)(*(X+25)) &gt;= 0 &amp;&amp; (int)(*(X+25)) &lt;= 59 &amp;&amp;            \
      (int)(*(X+26)) &gt;= 0 &amp;&amp; (int)(*(X+26)) &lt;= 60 )
`
修正的方式可以将mseed_buffer的前6个字节置为 0(ascii 0, 不是 &apos;0&apos;)，之前注意保存副本。

此外，可能会遇到大小端的问题
</code></pre><p>大小端转换</p>
<pre><code>`
#define BigtoLittle16(A) ((((u16)(A) &amp; 0xff00) &gt;&gt; 8) | (((u16)(A) &amp; 0x00ff) &lt;&lt; 8))
#define BigtoLittle32(A) ((((u32)(A) &amp; 0xff000000) &gt;&gt; 24) | (((u32)(A) &amp; 0x00ff0000) &gt;&gt; 8) | (((u32)(A) &amp; 0x0000ff00) &lt;&lt; 8)  | (((u32)(A) &amp; 0x000000ff) &lt;&lt; 24))
`
</code></pre><p>另外，可能需要在设计数据结构时，注意内存对齐，解决的方法是：修改数据结构，或者 添加编译器指令 <code>#pragma   pack(n)</code> .</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://johzzy.github.io/2015/11/15/2015-11-15-miniseed-note/" data-id="ckpz90v5l000u7jvq8mq2dbh2" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/public/page/2/">2</a><a class="page-number" href="/public/page/3/">3</a><a class="extend next" rel="next" href="/public/page/2/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/public/categories/未分类/">未分类</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/public/categories/未分类/">未分类</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/public/categories/%E6%97%A0%E8%81%8A/">未分类</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/public/categories/%E6%9C%AA%E5%88%86%E7%B1%BB/">未分类</a><span class="category-list-count">10</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/public/tags/C/" rel="tag">C</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/public/tags/C/" rel="tag">C++</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/public/tags/DES/" rel="tag">DES</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/public/tags/FTP/" rel="tag">FTP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/public/tags/Python/" rel="tag">Python</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/public/tags/SecureCRT/" rel="tag">SecureCRT</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/public/tags/ffmpeg/" rel="tag">ffmpeg</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/public/tags/lambda/" rel="tag">lambda</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/public/tags/shell/" rel="tag">shell</a><span class="tag-list-count">2</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/public/tags/C/" style="font-size: 10px;">C</a> <a href="/public/tags/C/" style="font-size: 10px;">C++</a> <a href="/public/tags/DES/" style="font-size: 10px;">DES</a> <a href="/public/tags/FTP/" style="font-size: 10px;">FTP</a> <a href="/public/tags/Python/" style="font-size: 20px;">Python</a> <a href="/public/tags/SecureCRT/" style="font-size: 10px;">SecureCRT</a> <a href="/public/tags/ffmpeg/" style="font-size: 10px;">ffmpeg</a> <a href="/public/tags/lambda/" style="font-size: 10px;">lambda</a> <a href="/public/tags/shell/" style="font-size: 15px;">shell</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/public/archives/2018/05/">May 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/public/archives/2016/08/">August 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/public/archives/2016/07/">July 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/public/archives/2016/06/">June 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/public/archives/2016/04/">April 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/public/archives/2016/01/">January 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/public/archives/2015/11/">November 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/public/archives/2015/01/">January 2015</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/public/archives/2014/11/">November 2014</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/public/archives/2014/10/">October 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/public/archives/2014/02/">February 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/public/archives/2013/04/">April 2013</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/public/2018/05/13/2018-05-13-ffmpeg-scale-samples/">ffmpeg scale samples</a>
          </li>
        
          <li>
            <a href="/public/2016/08/31/2016-08-31-fstab-shell-script/">一个简单的命令</a>
          </li>
        
          <li>
            <a href="/public/2016/08/29/2016-08-29-%E5%8D%95%E5%BC%95%E5%8F%B7%E2%80%99%E5%AD%97%E7%AC%A6%E4%B8%B2%E2%80%98/">单引号&#39;字符串&#39;</a>
          </li>
        
          <li>
            <a href="/public/2016/07/28/2016-07-28-centos_upgrade_python/">CentOS 升级 Python 整理记录</a>
          </li>
        
          <li>
            <a href="/public/2016/07/28/2016-07-28-centos_upgrade_gcc/">CentOS 升级 GCC 整理记录</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 johzzy<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/public/" class="mobile-nav-link">Home</a>
  
    <a href="/public/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/public/fancybox/jquery.fancybox.css">

  
<script src="/public/fancybox/jquery.fancybox.pack.js"></script>




<script src="/public/js/script.js"></script>




  </div>
</body>
</html>